/*! Rappid v3.0.0 - HTML5 Diagramming Framework - TRIAL VERSION

Copyright (c) 2015 client IO

 2019-08-09 


This Source Code Form is subject to the terms of the Rappid Trial License
, v. 2.0. If a copy of the Rappid License was not distributed with this
file, You can obtain one at http://jointjs.com/license/rappid_v2.txt
 or from the Rappid archive as was distributed by client IO. See the LICENSE file.*/


this.joint=this.joint||{},function(t,u,o,e,i){"use strict";o=o&&o.hasOwnProperty("default")?o.default:o;var n=u.mvc.View.extend({className:"widget",references:[],constructor:function(t,e){this.availableReferences=e||{},u.mvc.View.prototype.constructor.call(this,t)},updateAttrs:function(t){u.util.setAttributesBySelector(this.$el,t)},bindEvents:function(){},validateReferences:function(){var t=this.references||[],e=[];return t.forEach(function(t){void 0===this.availableReferences[t]&&e.push(t)},this),e},getReference:function(t){return this.availableReferences[t]},getReferences:function(){return this.availableReferences}}),r=n.extend({tagName:"label",events:{"change .input":"onChange",mousedown:"pointerdown",touchstart:"pointerdown",mouseup:"pointerup",touchend:"pointerup",click:"pointerclick"},documentEvents:{mouseup:"pointerup",touchend:"pointerup"},init:function(){u.util.bindAll(this,"pointerup")},render:function(){var t=this.options,e=o("<span/>").text(t.label||"");return this.$input=o("<input/>",{type:"checkbox",class:"input"}).prop("checked",!!t.value),this.$span=o("<span/>"),this.$el.append([e,this.$input,this.$span]),this},onChange:function(t){this.trigger("change",!!t.target.checked,t)},pointerdown:function(t){t=u.util.normalizeEvent(t),this.$el.addClass("is-in-action"),this.trigger("pointerdown",t),this.delegateDocumentEvents()},pointerclick:function(t){t=u.util.normalizeEvent(t),this.trigger("pointerclick",t)},pointerup:function(t){t=u.util.normalizeEvent(t),this.undelegateDocumentEvents(),this.trigger("pointerup",t),this.$el.removeClass("is-in-action"),"touchend"===t.type&&(this.$input.trigger("click"),t.preventDefault())}}),s=n.extend({tagName:"label",events:{"change input.toggle":"onChange","click input.toggle":"pointerclick",mousedown:"pointerdown",touchstart:"pointerdown",mouseup:"pointerup",touchend:"pointerup"},documentEvents:{mouseup:"pointerup",touchend:"pointerup"},init:function(){u.util.bindAll(this,"pointerup")},render:function(){var t=this.options,e=o("<span/>").text(t.label||""),i=o("<span><i/></span>");this.$input=o("<input/>",{type:"checkbox",class:"toggle"}).prop("checked",!!t.value);var n=o("<div/>").addClass(t.type);return this.$el.append([e,n.append(this.$input,i)]),this},onChange:function(t){this.trigger("change",!!t.target.checked,t)},pointerclick:function(t){t=u.util.normalizeEvent(t),this.trigger("pointerclick",t)},pointerdown:function(t){t=u.util.normalizeEvent(t),this.$el.addClass("is-in-action"),this.trigger("pointerdown",t),this.delegateDocumentEvents()},pointerup:function(t){t=u.util.normalizeEvent(t),this.undelegateDocumentEvents(),this.$el.removeClass("is-in-action"),this.trigger("pointerup",t),"touchend"===t.type&&(this.$input.trigger("click"),t.preventDefault())}}),p=n.extend({render:function(){return this.options.width&&this.$el.css({width:this.options.width}),this}}),a=n.extend({tagName:"label",render:function(){return this.$el.text(this.options.text),this}}),c=n.extend({events:{"change .input":"onChange","input .input":"onChange"},render:function(){var t,e=this.options;return this.$output=o("<output/>").text(e.value),t=o("<span/>").addClass("units").text(e.unit),this.$input=o("<input/>",{type:"range",name:e.type,min:e.min,max:e.max,step:e.step,class:"input"}).val(e.value),this.$el.append([this.$input,this.$output,t]),this},onChange:function(t){var e=parseInt(this.$input.val(),10);e!==this.currentValue&&(this.currentValue=e,this.$output.text(e),this.trigger("change",e,t))},setValue:function(t){this.$input.val(t),this.$input.trigger("change")}}),l=n.extend({render:function(){var t=u.util.omit(this.options,"type","group","index");return this.selectBox=new e.SelectBox(t),this.selectBox.render().$el.appendTo(this.el),this},bindEvents:function(){this.selectBox.on("all",this.trigger,this)}}),h=n.extend({events:{mousedown:"pointerdown",mouseup:"pointerup",touchend:"pointerup",touchstart:"pointerdown",click:"pointerclick"},tagName:"button",render:function(){var t=this.options;return this.$el.text(t.text),this},pointerclick:function(t){t=u.util.normalizeEvent(t),this.trigger("pointerclick",t)},pointerdown:function(t){t=u.util.normalizeEvent(t),this.trigger("pointerdown",t)},pointerup:function(t){t=u.util.normalizeEvent(t),this.trigger("pointerup",t),"touchend"===t.type&&(this.$el.trigger("click"),t.preventDefault())}}),d=n.extend({events:{mousedown:"pointerdown",touchstart:"pointerdown",mouseup:"pointerup",touchend:"pointerup",click:"pointerclick",focusin:"pointerfocusin",focusout:"pointerfocusout"},tagName:"div",render:function(){var t=this.options;return this.$label=o("<label/>").text(t.label),this.$text=o("<input/>",{type:"text",class:"input"}).val(t.value),this.$input=o("<div/>").addClass("input-wrapper").append(this.$text),this.$el.append([this.$label,this.$input]),this},pointerclick:function(t){t=u.util.normalizeEvent(t),this.trigger("pointerclick",t)},pointerdown:function(t){t=u.util.normalizeEvent(t),this.trigger("pointerdown",t),"touchstart"===t.type&&this.$text.trigger("focus")},pointerup:function(t){t=u.util.normalizeEvent(t),this.trigger("pointerup",t),"touchend"===t.type&&(this.$text.trigger("click"),t.preventDefault())},pointerfocusin:function(t){t=u.util.normalizeEvent(t),this.$el.addClass("is-focused"),this.trigger("pointerfocusin",t)},pointerfocusout:function(t){t=u.util.normalizeEvent(t),this.$el.removeClass("is-focused"),this.trigger("pointerfocusout",t)}}),g=n.extend({events:{mousedown:"pointerdown",touchstart:"pointerdown",mouseup:"pointerup",touchend:"pointerup",click:"pointerclick",focusin:"pointerfocusin",focusout:"pointerfocusout"},tagName:"div",render:function(){var t=this.options;return this.$label=o("<label/>").text(t.label),this.$number=o("<input/>",{type:"number",class:"number",max:t.max,min:t.min}).val(t.value),this.$input=o("<div/>").addClass("input-wrapper").append(this.$number),this.$el.append([this.$label,this.$input]),this},pointerclick:function(t){t=u.util.normalizeEvent(t),this.trigger("pointerclick",t)},pointerdown:function(t){t=u.util.normalizeEvent(t),this.trigger("pointerdown",t),"touchstart"===t.type&&this.$number.trigger("focus")},pointerup:function(t){t=u.util.normalizeEvent(t),this.trigger("pointerup",t),"touchend"===t.type&&(this.$number.trigger("click"),t.preventDefault())},pointerfocusin:function(t){t=u.util.normalizeEvent(t),this.$el.addClass("is-focused"),this.trigger("pointerfocusin",t)},pointerfocusout:function(t){t=u.util.normalizeEvent(t),this.$el.removeClass("is-focused"),this.trigger("pointerfocusout",t)}}),f=n.extend({events:{mousedown:"pointerdown",touchstart:"pointerdown",mouseup:"pointerup",touchend:"pointerup",click:"pointerclick",focusin:"pointerfocusin",focusout:"pointerfocusout"},tagName:"div",render:function(){var t=this.options;return this.$label=o("<label/>").text(t.label),this.$textarea=o("<textarea/>",{class:"textarea"}).text(t.value),this.$input=o("<div/>").addClass("input-wrapper").append(this.$textarea),this.$el.append([this.$label,this.$input]),this},pointerclick:function(t){t.preventDefault(),t=u.util.normalizeEvent(t),this.trigger("pointerclick",t)},pointerdown:function(t){t=u.util.normalizeEvent(t),this.trigger("pointerdown",t),"touchstart"===t.type&&this.$textarea.focus()},pointerup:function(t){t=u.util.normalizeEvent(t),this.trigger("pointerup",t),"touchend"===t.type&&(this.$textarea.trigger("click"),t.preventDefault())},pointerfocusin:function(t){t=u.util.normalizeEvent(t),this.$el.addClass("is-focused"),this.trigger("pointerfocusin",t)},pointerfocusout:function(t){t=u.util.normalizeEvent(t),this.$el.removeClass("is-focused"),this.trigger("pointerfocusout",t)}}),m=n.extend({render:function(){var t=u.util.omit(this.options,"type","group","index");return this.selectButtonGroup=new i.SelectButtonGroup(t),this.selectButtonGroup.render().$el.appendTo(this.el),this},bindEvents:function(){this.selectButtonGroup.on("all",this.trigger,this)}}),v=h.extend({references:["paperScroller"],options:{min:.2,max:5,step:.2},pointerdown:function(t){var e=this.options;this.getReferences().paperScroller.zoom(e.step,{max:e.max,grid:e.step}),h.prototype.pointerdown.call(this,t)}}),w=h.extend({references:["paperScroller"],options:{min:.2,max:5,step:.2},pointerdown:function(t){var e=this.options;this.getReferences().paperScroller.zoom(-e.step,{min:e.min,grid:e.step}),h.prototype.pointerdown.call(this,t)}}),$=h.extend({references:["paperScroller"],options:{min:.2,max:5,step:.2},pointerdown:function(t){var e=this.options;this.getReferences().paperScroller.zoomToFit({padding:20,scaleGrid:e.step,minScale:e.min,maxScale:e.max}),h.prototype.pointerdown.call(this,t)}}),x=c.extend({references:["paperScroller"],options:{min:20,max:500,step:20,value:100,unit:" %"},bindEvents:function(){this.on("change",function(t){this.getReferences().paperScroller.zoom(t/100,{absolute:!0,grid:this.options.step/100})},this),this.getReferences().paperScroller.options.paper.on("scale",function(t){this.setValue(Math.floor(100*t))},this)}}),b=h.extend({references:["commandManager"],pointerclick:function(){this.getReferences().commandManager.undo()}}),k=h.extend({references:["commandManager"],pointerclick:function(){this.getReferences().commandManager.redo()}}),E=h.extend({onRender:function(){var t=this.target=o(this.options.target)[0];t&&!o.contains(window.top.document,t)&&this.$el.hide()},pointerclick:function(){u.util.toggleFullScreen(this.target)}}),y=Object.freeze({checkbox:r,toggle:s,separator:p,label:a,range:c,selectBox:l,button:h,inputText:d,inputNumber:g,textarea:f,selectButtonGroup:m,zoomIn:v,zoomOut:w,zoomToFit:$,zoomSlider:x,undo:b,redo:k,fullscreen:E});n.create=function(t,e){var i=u.util.camelCase(u.util.isString(t)?t:t.type);if(!u.util.isFunction(y[i]))throw new Error('Widget: unable to find widget: "'+i+'"');var n=new y[i](t,e),o=n.validateReferences(e);if(0<o.length)throw new Error('Widget: "'+i+'" missing dependency: '+o.join(", "));return n.render(),n.updateAttrs(t.attrs),n.bindEvents(),n.$el.attr("data-type",i),t.name&&n.$el.attr("data-name",t.name),n};var z=u.mvc.View.extend({options:{},align:["left","right"],className:"toolbar",defaultGroup:"default",widgets:[],groupViews:[],init:function(){this.tools=u.util.toArray(this.options.tools),this.groups=this.options.groups||{}},getWidgetByName:function(e){return this.widgets.find(function(t){return t.options.name===e})},getWidgets:function(){return this.widgets},groupsWithItemsPairs:function(){var i={};this.tools.forEach(function(t){var e=t.group||this.defaultGroup;i[e]=i[e]||{items:[],group:{}},i[e].items.push(t),i[e].group=this.groups[e]||{}},this);for(var t=Object.keys(i),e=[],n=0,o=t.length;n<o;n++){var r=t[n];e.push([r,i[r]])}var s=u.util.sortBy(e,function(t){return t[1].group.index});return u.util.sortBy(s,function(t){return t[1].group.align||"left"})},render:function(){var t=this.groupsWithItemsPairs(),o=!1;return t.forEach(function(t){var e=t[0],i=t[1],n=this.renderGroup(e,i);!o&&i.group.align&&"right"===i.group.align&&(o=!0,n.addClass("group-first")),n.appendTo(this.el)},this),this},renderGroup:function(t,e){var i=new C({name:t,align:e.group.align,items:e.items,references:this.options.references});return this.groupViews.push(i),i.on("all",function(){this.trigger.apply(this,arguments)}.bind(this)),i.render(),this.widgets=this.widgets.concat(i.widgets),i.$el},onRemove:function(){u.util.invoke(this.groupViews,"off"),u.util.invoke(this.groupViews,"remove")}}),C=u.mvc.View.extend({className:"toolbar-group",init:function(){this.widgets=[]},onRender:function(){this.$el.attr("data-group",this.options.name),this.$el.addClass(this.options.align),this.renderItems()},renderItems:function(){u.util.toArray(this.options.items).forEach(function(t){var e=this.createWidget(t);this.$el.append(e.$el)},this)},createWidget:function(i){var t=n.create(i,this.options.references);return t.on("all",function(t){var e=Array.prototype.slice.call(arguments,1);this.trigger.apply(this,[i.name+":"+t].concat(e))}.bind(this)),this.widgets.push(t),t},onRemove:function(){u.util.invoke(this.widgets,"off"),u.util.invoke(this.widgets,"remove")}});t.Toolbar=z}(this.joint.ui=this.joint.ui||{},joint,$,joint.ui,joint.ui);