/*! Rappid v3.0.0 - HTML5 Diagramming Framework - TRIAL VERSION

Copyright (c) 2015 client IO

 2019-08-09 


This Source Code Form is subject to the terms of the Rappid Trial License
, v. 2.0. If a copy of the Rappid License was not distributed with this
file, You can obtain one at http://jointjs.com/license/rappid_v2.txt
 or from the Rappid archive as was distributed by client IO. See the LICENSE file.*/


this.joint=this.joint||{},function(t,a,p){"use strict";a=a&&a.hasOwnProperty("default")?a.default:a;var e=p.mvc.View.extend({className:"select-button-group",events:{"click .select-button-group-button":"onSelect","mouseover .select-button-group-button":"onOptionHover",mouseleave:"onMouseOut","mousedown .select-button-group-button":"pointerdown","touchstart .select-button-group-button":"pointerdown","mouseup .select-button-group-button":"pointerup","touchend .select-button-group-button":"pointerup"},options:{options:[],disabled:!1,multi:!1,selected:void 0,singleDeselect:!1,noSelectionValue:void 0,width:void 0,buttonWidth:void 0,buttonHeight:void 0,iconWidth:void 0,iconHeight:void 0},init:function(){p.util.bindAll(this,"onSelect","pointerup"),this.$el.data("view",this);var t=this.options.options,e=this.options.multi,i=this.options.selected;if(void 0===i){var o=p.util.toArray(t).filter(function(t){return t&&!0===t.selected});this.selection=e?o:o[0]}else this.selection=e?Array.isArray(i)?t.filter(function(t,e){return i.includes(e)}):[t[i]]:t[i]},render:function(){return this.renderOptions(this.selection),this.options.width&&this.$el.css("width",this.options.width),this.options.disabled&&this.disable(),this.$el.append(this.$options),this},renderOptions:function(){this.removeOptions(),p.util.toArray(this.options.options).forEach(function(t,e){var i=this.options.multi?this.selection.includes(t):this.selection===t,o=this.renderOption(t,e,i);this.$el.append(o),i&&o.addClass("selected")},this)},removeOptions:function(){this.$el.empty()},renderOption:function(t,e,i){var o=this.renderOptionContent(t,i);o.data("index",e);var n=t.buttonWidth||this.options.buttonWidth;n&&o.css("width",n);var s=t.buttonHeight||this.options.buttonHeight;return s&&o.css("height",s),o},renderOptionContent:function(t,e){var i=a("<div/>",{class:"select-button-group-button",html:t.content});if(t.icon||e&&t.iconSelected){var o=a("<img/>",{class:"select-button-group-button-icon",src:e&&t.iconSelected?t.iconSelected:t.icon}),n=t.iconWidth||this.options.iconWidth;n&&o.css("width",n);var s=t.iconHeight||this.options.iconHeight;s&&o.css("height",s),i.prepend(o)}return p.util.setAttributesBySelector(i,t.attrs),i},getOptionIndex:function(t){return a(t).closest(".select-button-group-button").data("index")},onSelect:function(t){if(!this.isDisabled()){var e=this.getOptionIndex(t.target);this.select(e,{ui:!0})}},onOptionHover:function(t){if(!this.isDisabled()){var e=this.getOptionIndex(t.target);this.trigger("option:hover",this.options.options[e],e)}},onMouseOut:function(t){this.isDisabled()||this.trigger("mouseout",t)},getSelection:function(){return this.selection},getSelectionValue:function(t){t=t||this.selection;var e=this.options.noSelectionValue;if(this.options.multi){var i=p.util.toArray(t);return 0===i.length?void 0!==e?e:void 0:i.map(function(t){var e=t.value;return void 0!==e?e:t.content})}if(!t)return void 0!==e?e:void 0;var o=t.value;return void 0!==o?o:t.content},select:function(t,e){var i=a(this.$(".select-button-group-button")[t]),o=this.options.options[t],n=null,s=null,l=null,c=null;if(this.options.multi)i.toggleClass("selected"),i.hasClass("selected")?(l=t,c=o,-1===this.selection.indexOf(o)&&this.selection.push(o),o.iconSelected&&i.find(".select-button-group-button-icon").attr("src",o.iconSelected)):(n=t,s=o,this.selection=p.util.without(this.selection,o),o.iconSelected&&i.find(".select-button-group-button-icon").attr("src",o.icon));else{var u=this.$(".selected"),r=u.index(),d=this.options.options[r];i.toggleClass("selected"),i.hasClass("selected")?(d&&(n=r,s=d,u.removeClass("selected"),d.iconSelected&&u.find(".select-button-group-button-icon").attr("src",d.icon)),l=t,c=o,(this.selection=o).iconSelected&&i.find(".select-button-group-button-icon").attr("src",o.iconSelected)):this.options.singleDeselect?(n=t,s=o,this.selection=void 0,o.iconSelected&&i.find(".select-button-group-button-icon").attr("src",o.icon)):i.addClass("selected")}var h=p.util.assign({},e);h.deselectedIndex=n,h.deselectedOption=s,h.selectedIndex=l,h.selectedOption=c,this.trigger("option:select",this.selection,t,h)},selectByValue:function(t,e){Array.isArray(t)||(t=[t]);for(var i=this.options.options||[],o=0;o<i.length;o++){var n=i[o];if(void 0===n.value&&t.includes(n.content))this.select(o,e);else if(void 0!==n.value){t.find(function(t){return p.util.isEqual(t,n.value)})&&this.select(o,e)}}},deselect:function(){this.$(".selected").removeClass("selected"),this.options.multi?this.selection=[]:this.selection=void 0},isDisabled:function(){return this.$el.hasClass("disabled")},enable:function(){this.$el.removeClass("disabled")},disable:function(){this.$el.addClass("disabled")},pointerdown:function(t){var e=this.getOptionIndex(t.target);a(this.$(".select-button-group-button")[e]).addClass("is-in-action"),a(document).on("mouseup.select-button-group touchend.select-button-group",this.pointerup)},pointerup:function(){this.$(".is-in-action").removeClass("is-in-action"),a(document).off("mouseup.select-button-group touchend.select-button-group")}});t.SelectButtonGroup=e}(this.joint.ui=this.joint.ui||{},$,joint);